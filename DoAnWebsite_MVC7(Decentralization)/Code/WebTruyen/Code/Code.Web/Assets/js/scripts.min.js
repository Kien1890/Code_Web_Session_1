function watermarkEnter(e, o) {
    e.value == o && (e.value = "",
    e.style.color = "",
    e.select())
}
function watermarkLeave(e, o) {
    "" == e.value && (e.value = o)
}
function trackUserLocation(e) {}
function Get_Cookie(e) {
    var o = document.cookie.split(";")
      , t = ""
      , i = ""
      , n = !1
      , r = "";
    for (r = 0; r < o.length; r++) {
        if ((t = o[r].split("="))[0].replace(/^\s+|\s+$/g, "") == e)
            return n = !0,
            t.length > 1 && (i = unescape(t[1].replace(/^\s+|\s+$/g, ""))),
            i;
        t = null
    }
    if (!n)
        return null
}
function Set_Cookie(e, o, t, i, n, r) {
    var l = new Date;
    l.setTime(l.getTime()),
    t && (t = 1e3 * t * 60 * 60 * 24);
    var s = new Date(l.getTime() + t);
    document.cookie = e + "=" + escape(o) + (t ? ";expires=" + s.toGMTString() : "") + (i ? ";path=" + i : "") + (n ? ";domain=" + n : "") + (r ? ";secure" : "")
}
function Delete_Cookie(e, o, t) {
    Get_Cookie(e) && (document.cookie = e + "=" + (o ? ";path=" + o : "") + (t ? ";domain=" + t : "") + ";expires=Thu, 01-Jan-1970 00:00:01 GMT")
}
var exitThisPagePrompt = "Are you sure you want to leave this page?"
  , alreadySetExitPrompt = !1
  , requireExitPrompt = !1
  , contentDidChange = !1;
function goodbye(e) {
    if (requireExitPrompt && contentDidChange)
        return exitThisPagePrompt
}
function hookupGoodbyePrompt(e) {
    contentDidChange = !0,
    !alreadySetExitPrompt && requireExitPrompt && (exitThisPagePrompt = e,
    alreadySetExitPrompt = !0,
    window.onbeforeunload = goodbye)
}
function unHookGoodbyePrompt() {
    requireExitPrompt = !1
}
!function(e, o, t, i) {
    var n = e(o);
    e.fn.lazyload = function(t) {
        var r, l = this, s = {
            threshold: 0,
            failure_limit: 0,
            event: "scroll.lazyload",
            effect: "show",
            container: o,
            data_attribute: "original",
            data_srcset: "srcset",
            skip_invisible: !1,
            appear: null,
            load: null,
            placeholder: "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs="
        };
        function d() {
            var o = 0;
            l.each(function() {
                var t = e(this);
                if (!s.skip_invisible || t.is(":visible"))
                    if (e.abovethetop(this, s) || e.leftofbegin(this, s))
                        ;
                    else if (e.belowthefold(this, s) || e.rightoffold(this, s)) {
                        if (++o > s.failure_limit)
                            return !1
                    } else
                        t.trigger("appear"),
                        o = 0
            })
        }
        return t && (i !== t.failurelimit && (t.failure_limit = t.failurelimit,
        delete t.failurelimit),
        i !== t.effectspeed && (t.effect_speed = t.effectspeed,
        delete t.effectspeed),
        e.extend(s, t)),
        r = s.container === i || s.container === o ? n : e(s.container),
        0 === s.event.indexOf("scroll") && r.off(s.event).on(s.event, function() {
            return d()
        }),
        this.each(function() {
            var o = this
              , t = e(o);
            o.loaded = !1,
            t.attr("src") !== i && !1 !== t.attr("src") || t.is("img") && t.attr("src", s.placeholder),
            t.one("appear", function() {
                if (!this.loaded) {
                    if (s.appear) {
                        var i = l.length;
                        s.appear.call(o, i, s)
                    }
                    e("<img />").one("load", function() {
                        var i = t.attr("data-" + s.data_attribute)
                          , n = t.attr("data-" + s.data_srcset);
                        i != t.attr("src") && (t.hide(),
                        t.is("img") && (t.attr("src", i),
                        null != n && t.attr("srcset", n)),
                        t.is("video") && t.attr("poster", i),
                        t[s.effect](s.effect_speed)),
                        o.loaded = !0;
                        var r = e.grep(l, function(e) {
                            return !e.loaded
                        });
                        if (l = e(r),
                        s.load) {
                            var d = l.length;
                            s.load.call(o, d, s)
                        }
                    }).attr({
                        src: t.attr("data-" + s.data_attribute),
                        srcset: t.attr("data-" + s.data_srcset) || ""
                    }).error(function() {
                        var e = t.attr("data-" + s.data_attribute);
                        e.search("bp.blogspot.com") > 0 && e.search("focus-opensocial.googleusercontent") <= 0 && (e = "https://images2-focus-opensocial.googleusercontent.com/gadgets/proxy?container=focus&gadget=a&no_expand=1&resize_h=0&rewriteMime=image%2F*&url=" + encodeURIComponent(e),
                        t.attr("src", e))
                    })
                }
            }),
            0 !== s.event.indexOf("scroll") && t.off(s.event).on(s.event, function() {
                o.loaded || t.trigger("appear")
            })
        }),
        n.off("resize.lazyload").bind("resize.lazyload", function() {
            d()
        }),
        /(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion) && n.on("pageshow", function(o) {
            o.originalEvent && o.originalEvent.persisted && l.each(function() {
                e(this).trigger("appear")
            })
        }),
        e(function() {
            d()
        }),
        this
    }
    ,
    e.belowthefold = function(t, r) {
        return (r.container === i || r.container === o ? (o.innerHeight ? o.innerHeight : n.height()) + n.scrollTop() : e(r.container).offset().top + e(r.container).height()) <= e(t).offset().top - r.threshold
    }
    ,
    e.rightoffold = function(t, r) {
        return (r.container === i || r.container === o ? n.width() + n.scrollLeft() : e(r.container).offset().left + e(r.container).width()) <= e(t).offset().left - r.threshold
    }
    ,
    e.abovethetop = function(t, r) {
        return (r.container === i || r.container === o ? n.scrollTop() : e(r.container).offset().top) >= e(t).offset().top + r.threshold + e(t).height()
    }
    ,
    e.leftofbegin = function(t, r) {
        return (r.container === i || r.container === o ? n.scrollLeft() : e(r.container).offset().left) >= e(t).offset().left + r.threshold + e(t).width()
    }
    ,
    e.inviewport = function(o, t) {
        return !(e.rightoffold(o, t) || e.leftofbegin(o, t) || e.belowthefold(o, t) || e.abovethetop(o, t))
    }
    ,
    e.extend(e.expr[":"], {
        "below-the-fold": function(o) {
            return e.belowthefold(o, {
                threshold: 0
            })
        },
        "above-the-top": function(o) {
            return !e.belowthefold(o, {
                threshold: 0
            })
        },
        "right-of-screen": function(o) {
            return e.rightoffold(o, {
                threshold: 0
            })
        },
        "left-of-screen": function(o) {
            return !e.rightoffold(o, {
                threshold: 0
            })
        },
        "in-viewport": function(o) {
            return e.inviewport(o, {
                threshold: 0
            })
        },
        "above-the-fold": function(o) {
            return !e.belowthefold(o, {
                threshold: 0
            })
        },
        "right-of-fold": function(o) {
            return e.rightoffold(o, {
                threshold: 0
            })
        },
        "left-of-fold": function(o) {
            return !e.rightoffold(o, {
                threshold: 0
            })
        }
    })
}(jQuery, window, document),
function(e) {
    e.isScrollToFixed = function(o) {
        return !!e(o).data("ScrollToFixed")
    }
    ,
    e.ScrollToFixed = function(o, t) {
        var i = this;
        i.$el = e(o),
        i.el = o,
        i.$el.data("ScrollToFixed", i);
        var n, r, l, s, d = !1, a = i.$el, f = 0, c = 0, p = -1, u = -1, h = null;
        function x() {
            var e = i.options.limit;
            return e ? "function" == typeof e ? e.apply(a) : e : 0
        }
        function g() {
            return "fixed" === n
        }
        function m() {
            return "absolute" === n
        }
        function b() {
            return !(g() || m())
        }
        function T() {
            if (!g()) {
                var e = a[0].getBoundingClientRect();
                h.css({
                    display: a.css("display"),
                    width: e.width,
                    height: e.height,
                    float: a.css("float")
                }),
                cssOptions = {
                    "z-index": i.options.zIndex,
                    position: "fixed",
                    top: -1 == i.options.bottom ? S() : "",
                    bottom: -1 == i.options.bottom ? "" : i.options.bottom,
                    "margin-left": "0px"
                },
                i.options.dontSetWidth || (cssOptions.width = a.css("width")),
                a.css(cssOptions),
                a.addClass(i.options.baseClassName),
                i.options.className && a.addClass(i.options.className),
                n = "fixed"
            }
        }
        function F() {
            var e = x()
              , o = c;
            i.options.removeOffsets && (o = "",
            e -= f),
            cssOptions = {
                position: "absolute",
                top: e,
                left: o,
                "margin-left": "0px",
                bottom: ""
            },
            i.options.dontSetWidth || (cssOptions.width = a.css("width")),
            a.css(cssOptions),
            n = "absolute"
        }
        function v() {
            b() || (u = -1,
            h.css("display", "none"),
            a.css({
                "z-index": s,
                width: "",
                position: r,
                left: "",
                top: l,
                "margin-left": ""
            }),
            a.removeClass("scroll-to-fixed-fixed"),
            i.options.className && a.removeClass(i.options.className),
            n = null)
        }
        function w(e) {
            e != u && (a.css("left", c - e),
            u = e)
        }
        function S() {
            var e = i.options.marginTop;
            return e ? "function" == typeof e ? e.apply(a) : e : 0
        }
        function A() {
            if (e.isScrollToFixed(a) && !a.is(":hidden")) {
                var o = d
                  , t = b();
                d ? b() && (f = a.offset().top,
                c = a.offset().left) : (a.trigger("preUnfixed.ScrollToFixed"),
                v(),
                a.trigger("unfixed.ScrollToFixed"),
                u = -1,
                f = a.offset().top,
                c = a.offset().left,
                i.options.offsets && (c += a.offset().left - a.position().left),
                -1 == p && (p = c),
                n = a.css("position"),
                d = !0,
                -1 != i.options.bottom && (a.trigger("preFixed.ScrollToFixed"),
                T(),
                a.trigger("fixed.ScrollToFixed")));
                var l = e(window).scrollLeft()
                  , s = e(window).scrollTop()
                  , h = x();
                i.options.minWidth && e(window).width() < i.options.minWidth ? b() && o || (y(),
                a.trigger("preUnfixed.ScrollToFixed"),
                v(),
                a.trigger("unfixed.ScrollToFixed")) : i.options.maxWidth && e(window).width() > i.options.maxWidth ? b() && o || (y(),
                a.trigger("preUnfixed.ScrollToFixed"),
                v(),
                a.trigger("unfixed.ScrollToFixed")) : -1 == i.options.bottom ? h > 0 && s >= h - S() ? t || m() && o || (y(),
                a.trigger("preAbsolute.ScrollToFixed"),
                F(),
                a.trigger("unfixed.ScrollToFixed")) : s >= f - S() ? (g() && o || (y(),
                a.trigger("preFixed.ScrollToFixed"),
                T(),
                u = -1,
                a.trigger("fixed.ScrollToFixed")),
                w(l)) : b() && o || (y(),
                a.trigger("preUnfixed.ScrollToFixed"),
                v(),
                a.trigger("unfixed.ScrollToFixed")) : h > 0 ? s + e(window).height() - a.outerHeight(!0) >= h - (S() || -function() {
                    if (!i.options.bottom)
                        return 0;
                    return i.options.bottom
                }()) ? g() && (y(),
                a.trigger("preUnfixed.ScrollToFixed"),
                "absolute" === r ? F() : v(),
                a.trigger("unfixed.ScrollToFixed")) : (g() || (y(),
                a.trigger("preFixed.ScrollToFixed"),
                T()),
                w(l),
                a.trigger("fixed.ScrollToFixed")) : w(l)
            }
        }
        function y() {
            var e = a.css("position");
            "absolute" == e ? a.trigger("postAbsolute.ScrollToFixed") : "fixed" == e ? a.trigger("postFixed.ScrollToFixed") : a.trigger("postUnfixed.ScrollToFixed")
        }
        var C = function(e) {
            a.is(":visible") && (d = !1,
            A())
        }
          , _ = function(e) {
            window.requestAnimationFrame ? requestAnimationFrame(A) : A()
        };
        i.init = function() {
            i.options = e.extend({}, e.ScrollToFixed.defaultOptions, t),
            s = a.css("z-index"),
            i.$el.css("z-index", i.options.zIndex),
            h = e("<div />"),
            n = a.css("position"),
            r = a.css("position"),
            a.css("float"),
            l = a.css("top"),
            b() && i.$el.after(h),
            e(window).bind("resize.ScrollToFixed", C),
            e(window).bind("scroll.ScrollToFixed", _),
            "ontouchmove"in window && e(window).bind("touchmove.ScrollToFixed", A),
            i.options.preFixed && a.bind("preFixed.ScrollToFixed", i.options.preFixed),
            i.options.postFixed && a.bind("postFixed.ScrollToFixed", i.options.postFixed),
            i.options.preUnfixed && a.bind("preUnfixed.ScrollToFixed", i.options.preUnfixed),
            i.options.postUnfixed && a.bind("postUnfixed.ScrollToFixed", i.options.postUnfixed),
            i.options.preAbsolute && a.bind("preAbsolute.ScrollToFixed", i.options.preAbsolute),
            i.options.postAbsolute && a.bind("postAbsolute.ScrollToFixed", i.options.postAbsolute),
            i.options.fixed && a.bind("fixed.ScrollToFixed", i.options.fixed),
            i.options.unfixed && a.bind("unfixed.ScrollToFixed", i.options.unfixed),
            i.options.spacerClass && h.addClass(i.options.spacerClass),
            a.bind("resize.ScrollToFixed", function() {
                h.height(a.height())
            }),
            a.bind("scroll.ScrollToFixed", function() {
                a.trigger("preUnfixed.ScrollToFixed"),
                v(),
                a.trigger("unfixed.ScrollToFixed"),
                A()
            }),
            a.bind("detach.ScrollToFixed", function(o) {
                !function(e) {
                    (e = e || window.event).preventDefault && e.preventDefault(),
                    e.returnValue = !1
                }(o),
                a.trigger("preUnfixed.ScrollToFixed"),
                v(),
                a.trigger("unfixed.ScrollToFixed"),
                e(window).unbind("resize.ScrollToFixed", C),
                e(window).unbind("scroll.ScrollToFixed", _),
                a.unbind(".ScrollToFixed"),
                h.remove(),
                i.$el.removeData("ScrollToFixed")
            }),
            C()
        }
        ,
        i.init()
    }
    ,
    e.ScrollToFixed.defaultOptions = {
        marginTop: 0,
        limit: 0,
        bottom: -1,
        zIndex: 1e3,
        baseClassName: "scroll-to-fixed-fixed"
    },
    e.fn.scrollToFixed = function(o) {
        return this.each(function() {
            new e.ScrollToFixed(this,o)
        })
    }
}(jQuery);
function HideMenuToolbar() {
    $("#toolbar").fadeOut(),
    $("#toolbarbut").fadeIn("slow")
}
function ShowMenuToolbar() {
    $("#toolbar").fadeIn(),
    $("#toolbarbut").fadeOut("slow")
}
function SetReferrerPolicy(e) {
    var t = document.querySelector('meta[name="referrer"]');
    if (null != t)
        1 == e ? t.setAttribute("content", "no-referrer") : t.setAttribute("content", "no-referrer-when-downgrade");
    else {
        var n = document.createElement("meta");
        n.name = "referrer",
        n.content = 1 == e ? "no-referrer" : "no-referrer-when-downgrade",
        document.getElementsByTagName("head")[0].appendChild(n)
    }
}
var hostName = "nettruyen.com";
globalOpts.siteRoot && (hostName = globalOpts.siteRoot);
var siteRoot = "//f." + hostName
  , AjaxHelper = {
    loadWaiting: !1,
    init: function() {
        this.loadWaiting = !1
    },
    setLoadWaiting: function(e) {
        var t = '<div id="loading" style="display:block"><img src="//s.' + hostName + '/data/sites/1/skins/comic/images/loading-small.gif" alt="loading"><span>Đang xử lý</span></div>';
        if (!0 === e)
            document.querySelector("body").insertAdjacentHTML("beforeend", t);
        else if (null != document.querySelector("#loading")) {
            var n = document.querySelector("#loading");
            n.parentElement.removeChild(n)
        }
        this.loadWaiting = e
    },
    processAjaxError: function(e) {
        alert("Có lỗi xảy ra. Vui lòng thử lại..."),
        setTimeout(function() {
            location.reload()
        }, 100)
    },
    setHeaders: function(e) {
        e.setRequestHeader("token", globalOpts.token)
    }
};
function reCrawler() {
    ajaxComicPost("ReCrawlerChapter", refreshCallback, {
        chapterId: $(".chapter-id").attr("data-id")
    })
}
function fixChapter() {
    ajaxComicPost("FixChapter", refreshCallback, {
        chapterId: $(".chapter-id").attr("data-id")
    })
}
function deleteChapterPage(e) {
    ajaxComicPost("DeleteChapterPage", deleteChapterPageCallback, {
        chapterId: $(".chapter-id").attr("data-id"),
        index: $(e).parent().index(".page-chapter")
    })
}
function deleteChapterPageCallback(e) {
    $(".page-chapter").eq(e.index).slideUp(function() {
        $(this).remove()
    })
}
function refreshCallback(e) {
    1 == e.success && location.reload()
}
function ajaxComicPost(e, t, n) {
    0 == AjaxHelper.loadWaiting && (AjaxHelper.setLoadWaiting(!0),
    $.ajax({
        type: "POST",
        url: "/Comic/Services/ComicService.asmx/" + e,
        data: n,
        success: function(e) {
            void 0 !== t && t(e)
        },
        complete: function(e) {
            AjaxHelper.setLoadWaiting(!1)
        },
        error: function(e, t, n) {
            AjaxHelper.processAjaxError(n)
        }
    }))
}
$(document).ready(function() {
    $("span.downarr a").click(function() {
        HideMenuToolbar(),
        Set_Cookie("openstate", "closed", 1, "/")
    }),
    $("span.showbar a").click(function() {
        ShowMenuToolbar(),
        Set_Cookie("openstate", "open", 1, "/")
    }),
    $("span.downarr a, span.showbar a").click(function() {
        return !1
    });
    var e = Get_Cookie("openstate");
    null != e && ("closed" == e && HideMenuToolbar(),
    "open" == e && ShowMenuToolbar()),
    $("#back-to-top").hide(),
    $(function() {
        $(window).scroll(function() {
            $(this).scrollTop() > 100 ? $("#back-to-top").fadeIn() : $("#back-to-top").fadeOut()
        }),
        $("#back-to-top").click(function() {
            return $("body,html").animate({
                scrollTop: 0
            }, 800),
            !1
        })
    });
    var t = window.innerWidth;
    $(".comicsearchbox input[type='submit']").click(function() {
        var e = $(".suggestsearch");
        if ($(e).find("li.selected").length) {
            var t = $(e).find("li.selected").eq(0).children("a").attr("href");
            return window.location.href = t,
            !1
        }
        var n = $(this).parents(".comicsearchbox").find("input[type='text']");
        return "" == n.val() ? (n.focus(),
            !1) : (window.location.href = "/Home/Search?keyword=" + encodeURIComponent(n.val()).replace(/%20/g, "+"),
        !1)
    });
    var n = !1
      , i = null;
    $(".comicsearchbox input[type='text']").keyup(function(e) {
        !function(e, t) {
            0 == n && (SetReferrerPolicy(!0),
            n = !0);
            new Date;
            var o, r = $(e).parent().find(".suggestsearch ul");
            if (40 == t.which)
                return void (0 == $(r).find(".selected").length ? $(r).find("li").first().addClass("selected") : (o = $(r).find(".selected").next(),
                o.hasClass("li-group") && (o = o.next()),
                $(r).find(".selected").removeClass("selected"),
                o.addClass("selected")));
            if (38 == t.which)
                return void (0 == $(r).find(".selected").length ? $(r).find("li").last().addClass("selected") : (o = $(r).find(".selected").prev(),
                o.hasClass("li-group") && (o = o.prev()),
                $(r).find(".selected").removeClass("selected"),
                o.addClass("selected")));
            if (13 == t.which)
                return void $(e).parent().find(".searchbutton").trigger("click");
            clearTimeout(i),
            i = setTimeout(function() {
                var t = $(e).parent();
                $(t).find(".suggestsearch").length || $(t).append("<div class='suggestsearch'></div>");
                var n = $(t).find(".suggestsearch")
                  , i = $(e).val()
                  , o = i.trim().toLowerCase();
                o.length < 1 ? $(n).hide() : o.length >= 1 && ($(e).addClass("loading"),
                $.ajax({
                    url: "/Home/SearchTruyen",
                    type: "GET",
                    dataType: "html",
                    data: {
                        q: o
                    },
                    cache: !0,
                    success: function (data) {
                        $(e).removeClass("loading"),
                            "" == data || " " == data ? $(n).hide() : $(n).html(data).show(),
                        1 == a && ($(".pagenotfound .not-found .searchinput").val(""),
                        a = !1)
                    }
                }))
            }, 300)
        }(this, e)
    }),
    $(".comicsearchbox input[type='text']").focus(function() {
        t < 768 ? $(".search-box").addClass("search-box-expanded") : $(".search-box").removeClass("search-box-expanded"),
        window.scrollTo(0, window.scrollY)
    }).blur(function() {
        $(".search-box").removeClass("search-box-expanded")
    }),
    $("html").click(function() {
        $(".suggestsearch").hide(),
        $(".notification-popup").remove()
    });
    var a = !1;
    if ($("body").hasClass("pagenotfound")) {
        $(".pagenotfound .searchbutton").click(function() {
            var e = $(this).parents(".comicsearchbox").find(".searchinput");
            return e.val().length && (location.href = "/Home/Search?keyword=" + encodeURIComponent(e.val()).replace(/%20/g, "+")),
            !1
        }),
        $(".pagenotfound .comicsearchbox input[type='text']").keyup(function(e) {
            13 != e.which || $(".pagenotfound .comicsearchbox .searchbutton").trigger("click")
        });
        var o = window.location.pathname
          , r = "";
        if (o.startsWith("/truyen-tranh/") ? r = o.replace("/truyen-tranh/", "") : o.startsWith("/truyen/") && (r = o.replace("/truyen/", "")),
        "" != r) {
            var s = r.split("/");
            s.length > 0 && (a = !0,
            $(".pagenotfound .not-found .searchinput").val(s[0].replace(/-/g, " ")).focus().trigger("keyup"))
        }
    }
    function c() {
        $(".notifications").length && ($(".notifications").eq(0).removeClass("hidden").insertBefore($(".search-button-icon")),
        $(".notifications").eq(1).remove(),
        $("body").on("click", ".notifications > a", function(e) {
            e.preventDefault();
            if (0 == AjaxHelper.loadWaiting)
                return AjaxHelper.setLoadWaiting(!0),
                $.ajax({
                    type: "POST",
                    url: "/Comic/Services/ComicService.asmx/GetNotifications",
                    data: {
                        page: 1
                    },
                    success: function(e) {
                        e.success && e.notifications && ($(".notification-popup").remove(),
                        $('<div class="notification-popup"></div>').html(e.notifications).appendTo($(".notifications")),
                        $(".notifications .notification-count").text("0"))
                    },
                    complete: function(e) {
                        AjaxHelper.setLoadWaiting(!1)
                    },
                    error: function(e, t, n) {}
                }),
                !1
        }),
        $("body").on("click", ".notifications .notification-popup .notification-content a", function(e) {
            e.preventDefault();
            var t = $(this);
            return $.ajax({
                type: "POST",
                url: "/Comic/Services/ComicService.asmx/ReadNotification",
                data: {
                    id: t.attr("data-id")
                },
                success: function(e) {
                    window.location.href = t.attr("href")
                },
                complete: function(e) {
                    AjaxHelper.setLoadWaiting(!1)
                },
                error: function(e, t, n) {}
            }),
            !1
        }))
    }
    function l() {
        if ($("body").hasClass("chapter-detail"))
            Z(!0);
        else if ($("body").hasClass("comic-detail"))
            Z(!1);
        else if ($(".comics-followed-page").length || $(".comics-followed").length) {
            if (0 != AjaxHelper.loadWaiting)
                return;
            AjaxHelper.setLoadWaiting(!0);
            var e = function(e, t) {
                t || (t = window.location.href);
                e = e.replace(/[\[\]]/g, "\\$&");
                var n = new RegExp("[?&]" + e + "(=([^&#]*)|&|#|$)").exec(t);
                return n ? n[2] ? decodeURIComponent(n[2].replace(/\+/g, " ")) : "" : null
            }("page");
            null == e && (e = 1);
            var t = 0
              , n = $(".comics-followed-page");
            $(".comics-followed-nopaging").length ? (t = 1,
            n = $(".comics-followed")) : $(".comics-followed-withpaging").length && (t = 2,
            n = $(".comics-followed")),
            $.ajax({
                type: "GET",
                url: siteRoot + "/Comic/Services/ComicService.asmx/GetFollowedPageComics",
                data: {
                    page: e,
                    userGuid: X(),
                    loadType: t,
                    token: globalOpts.userKey ? globalOpts.userKey : ""
                },
                success: function(e) {
                    if (e.success)
                        if (e.followedListHtml)
                            n.html(Q(e.followedListHtml)),
                            K(),
                            e.pagerHtml && $('<div class="pagination-outter"></div>').html(e.pagerHtml).appendTo(n),
                            $("html, body").animate({
                                scrollTop: 0
                            }, 0, "linear");
                        else if (0 == t) {
                            n.html('<p>Bạn chưa theo dõi truyện nào cả. Để theo dõi truyện, nhấn vào <u>Theo dõi</u> như hình bên dưới:<br />Bạn nên <a href="/Secure/Login.aspx">Đăng nhập</a> để truy cập truyện đã theo dõi của bạn ở bất cứ đâu</p><p class="text-center"><img src="/Data/Sites/1/media/huong-dan-theo-doi-truyen.jpg" alt="Hướng dẫn theo dõi truyện tranh"></img></p>')
                        }
                },
                complete: function(e) {
                    AjaxHelper.setLoadWaiting(!1)
                },
                error: function(e, t, n) {
                    console.log(n)
                }
            })
        }
        ce(".comics-followed-block"),
        ce(".chapter-nav-bottom")
    }
    ($(".alertError").click(function() {
        var e = $(".chapter-id").attr("data-id");
        $.ajax({
            url: "/Comic/Services/ComicService.asmx/ReportChapterForm",
            type: "post",
            dataType: "json",
            data: {
                chapterId: e
            },
            success: function(t) {
                t.success && t.reportFormHtml && ($("body").addClass("modal-open").append(t.reportFormHtml),
                $(".btn-send-report").click(function() {
                    var t = $(".ddl-error-type").val()
                      , n = $(".error-content input").val();
                    if ("-1" == t)
                        return $(".ddl-error-type").focus(),
                        void alert("Vui lòng chọn loại lỗi.");
                    if ("" == n)
                        return $(".error-content input").focus(),
                        void alert("Vui lòng nhập Nội dung lỗi");
                    if (0 == AjaxHelper.loadWaiting) {
                        AjaxHelper.setLoadWaiting(!0);
                        var i = "";
                        $(".g-recaptcha").length && (i = grecaptcha.getResponse()),
                        $.ajax({
                            url: "/Comic/Services/ComicService.asmx/ReportChapter",
                            type: "post",
                            dataType: "json",
                            data: {
                                chapterId: e,
                                errorType: t,
                                errorText: n,
                                captcha: i
                            },
                            success: function(e) {
                                e.message && alert(e.message),
                                e.success && ($("body").removeClass("modal-open"),
                                $(".modal").remove(),
                                $(".modal-backdrop").remove())
                            },
                            complete: function(e) {
                                AjaxHelper.setLoadWaiting(!1)
                            }
                        })
                    }
                }))
            }
        })
    }),
    $("body").on("click", ".follow-link", function() {
        if (0 == AjaxHelper.loadWaiting) {
            AjaxHelper.setLoadWaiting(!0);
            var e = $(this)
              , t = null;
            $("body").hasClass("comic-detail") && (t = $(e).parent().find("b"));
            var n = $(e).attr("data-id");
            $.ajax({
                url: "/Comic/Services/FollowComic.ashx",
                type: "post",
                dataType: "json",
                beforeSend: AjaxHelper.setHeaders,
                data: {
                    id: n
                },
                cache: !0,
                success: function(n) {
                    "0" == n.responseCode ? alert(n.responseText) : ("1" == n.responseCode ? ($(e).html('<i class="fa fa-times"></i> Bỏ theo dõi'),
                    $(e).hasClass("btn-success") && $(e).removeClass("btn-success").addClass("btn-danger")) : ($(e).html('<i class="fa fa-heart"></i> Theo dõi'),
                    $(e).hasClass("btn-danger") && $(e).removeClass("btn-danger").addClass("btn-success")),
                    null != t && t.text(n.responseText))
                },
                complete: function(e) {
                    AjaxHelper.setLoadWaiting(!1)
                },
                error: function(e, t, n) {
                    AjaxHelper.processAjaxError(n)
                }
            })
        }
    }),
    $("body").on("click", '.modal button[data-dismiss="modal"]', function() {
        $("body").removeClass("modal-open"),
        $(".modal").remove(),
        $(".modal-backdrop").remove()
    }),
    c(),
    $("body").on("click", ".mark-as-read", function(e) {
        e.preventDefault();
        var t = $(this);
        return $.ajax({
            type: "POST",
            url: "/Comic/Services/ComicService.asmx/MarkAsRead",
            data: {
                comicId: t.attr("data-id"),
                userGuid: X()
            },
            success: function(e) {
                t.parents(".unread").find(".chapter a").addClass("visited"),
                t.parents(".unread").removeClass(".unread"),
                t.parents(".list-chapter").find(".chapter a").addClass("visited"),
                t.remove()
            }
        }),
        !1
    }),
    0 == globalOpts.init ? $.ajax({
        type: "GET",
        url: "/Comic/Services/ComicService.asmx/GetAuth",
        success: function(e) {
            if (e.success && e.data) {
                var t = "?returnurl=" + encodeURIComponent(window.location.pathname + window.location.search);
                $(".nav-account").html(e.data.replace("/Login.aspx", "/Login.aspx" + t).replace("/Register.aspx", "/Register.aspx" + t)),
                c(),
                f(),
                l()
            }
        }
    }) : l(),
    $(".changed-redirect").change(function() {
        window.location = $(this).val()
    }),
    $(".chapter a").length) && ("undefined" != typeof Storage && void 0 !== localStorage["visited-chapters"] && (S = JSON.parse(localStorage["visited-chapters"])).forEach(function(e) {
        $('.chapter a[href$="/' + e + '"]').addClass("visited")
    }));
    if ($("body").hasClass("chapter-detail") && ("undefined" != typeof Storage && (h = parseInt($(".chapter-id").data("id")))))
        if (void 0 !== localStorage["visited-chapters"]) {
            if (-1 == (S = JSON.parse(localStorage["visited-chapters"])).indexOf(h)) {
                if (S.push(h),
                S.length > 3e3)
                    for (var d = 0; d < 2e3; d++)
                        S.shift();
                localStorage["visited-chapters"] = JSON.stringify(S)
            }
        } else
            (E = []).push(h),
            localStorage["visited-chapters"] = JSON.stringify(E);
    var h, u = {
        Android: function() {
            return navigator.userAgent.match(/Android/i)
        },
        BlackBerry: function() {
            return navigator.userAgent.match(/BlackBerry/i)
        },
        iOS: function() {
            return navigator.userAgent.match(/iPhone|iPad|iPod/i)
        },
        Opera: function() {
            return navigator.userAgent.match(/Opera Mini/i)
        },
        Windows: function() {
            return navigator.userAgent.match(/IEMobile/i)
        },
        any: function() {
            return u.Android() || u.BlackBerry() || u.iOS() || u.Opera() || u.Windows()
        }
    }, p = u.any();
    function f() {
        $(".nav-account>li").hover(function() {
            $(this).addClass("open")
        }, function() {
            $(this).removeClass("open")
        }),
        p && $(".nav-account>li.dropdown>a").click(function() {
            return m(this),
            !1
        })
    }
    function m(e) {
        $(e).parent().hasClass("open") ? $("li.dropdown.open").removeClass("open") : ($("li.dropdown.open").removeClass("open"),
        $(e).parent().addClass("open"))
    }
    $(".navbar-nav>li").hover(function() {
        $(".navbar-nav > li.active").removeClass("active").addClass("curr"),
        $(this).addClass("open")
    }, function() {
        $(".navbar-nav > li.curr").removeClass("curr").addClass("active"),
        $(this).removeClass("open")
    }),
    p && $(".main-menu>li.dropdown>a").click(function() {
        return m(this),
        !1
    }),
    $(".nav-tabs li a").click(function() {
        return $(".nav-tabs li").removeClass("active"),
        $(".tab-content .tab-pane").removeClass("active").removeClass("in"),
        $(this).parent().addClass("active"),
        $($(this).attr("href")).addClass("active").addClass("in"),
        !1
    }),
    f(),
    $(".megamenu ul li a").hover(function() {
        $(".megamenu p").addClass("separator").text($(this).attr("data-title"))
    }, function() {
        $(".megamenu p").removeClass("separator").text("")
    }),
    $(".navbar-toggle").click(function() {
        $("body").hasClass("menu-open") ? ($("body").removeClass("menu-open"),
        $(this).find(".fa").removeClass("fa-times").addClass("fa-bars")) : ($("body").addClass("menu-open"),
        $(this).find(".fa").removeClass("fa-bars").addClass("fa-times"))
    }),
    $(".search-button-icon").click(function() {
        $(".navbar-toggle").trigger("click"),
        $(".navbar-collapse .searchinput").focus()
    }),
    $(".navbar-collapse .searchinput").focus(function() {
        window.scrollTo(0, 0)
    }),
    p && $(".facebook-like .tip").addClass("hidden");
    try {
        if (top.location.hostname != self.location.hostname)
            throw 1
    } catch (e) {
        top.location.href = self.location.href
    }
    if ($(".items-slide").length) {
        var g = $(".items-slide .owl-carousel");
        g.owlCarousel({
            lazyLoad: !0,
            autoPlay: 5e3,
            stopOnHover: !0,
            slideSpeed: 300,
            paginationSpeed: 800,
            itemsCustom: [[0, 1], [360, 2], [480, 3], [768, 4], [992, 5]]
        }),
        $(".items-slide .next").click(function() {
            return g.trigger("owl.next"),
            !1
        }),
        $(".items-slide .prev").click(function() {
            return g.trigger("owl.prev"),
            !1
        })
    }
    if (K(),
    p || $(".jtip").hover(function() {
        var e = $($(this).data("jtip"));
        if (!e.length)
            return !1;
        e.find(".box_img img").attr("src", e.find(".box_img img").attr("data-original")),
        $('<div id="cluetip"></div>').html(e.html()).appendTo("body").fadeIn("300")
    }, function() {
        $("#cluetip").remove()
    }).mousemove(function(e) {
        var t = e.pageX + 20
          , n = e.pageY + 10;
        $("#cluetip").css({
            top: n,
            left: t
        })
    }),
    $(".star").length && $(".star").raty({
        path: "http://st." + hostName + "/Data/Sites/1/skins/comic/images/",
        score: function() {
            return $(this).attr("data-rating")
        },
        half: !0,
        readOnly: "false" == $(".star").attr("data-allowrating"),
        click: function(e, t) {
            var n = {
                comicId: $(this).attr("data-id"),
                rate: parseInt(e)
            };
            $.ajax({
                type: "POST",
                url: "/Comic/Services/ComicService.asmx/RatingComic",
                data: n,
                success: function(e) {
                    0 == e.success && alert(e.response)
                },
                error: function(e, t, n) {
                    AjaxHelper.processAjaxError(n)
                }
            })
        }
    }),
    ($("body").hasClass("chapter-detail") ? $(".chapter-nav") : t >= 768 ? $(".main-nav") : $(".header")).scrollToFixed({
        preFixed: function() {
            $(".floatads").addClass("scroll-to-fixed-fixed")
        },
        preUnfixed: function() {
            $(".floatads").removeClass("scroll-to-fixed-fixed")
        }
    }),
    p) {
        var v, b = 0;
        $(window).scroll(function(e) {
            v = !0
        }),
        setInterval(function() {
            if (v) {
                var e = $(this).scrollTop();
                if (Math.abs(b - e) <= 5)
                    return;
                e > 100 ? e > b ? $(".scroll-to-fixed-fixed").removeClass("scroll-up").addClass("scroll-down") : $(".scroll-to-fixed-fixed").removeClass("scroll-down").addClass("scroll-up") : $(".scroll-to-fixed-fixed").removeClass("scroll-down"),
                b = e,
                v = !1
            }
        }, 0)
    }
    ($.fn.shorten = function(e) {
        var t = {
            maxHeight: 42,
            ellipsesText: "...",
            moreText: "Xem thêm <i class='fa fa-angle-right'></i>",
            lessText: "<i class='fa fa-angle-left'></i> Thu gọn"
        };
        return e && $.extend(t, e),
        $(document).off("click", ".morelink"),
        $(document).on({
            click: function() {
                var e = $(this);
                return e.hasClass("less") ? (e.removeClass("less"),
                e.html(t.moreText),
                e.prev().addClass("shortened")) : (e.addClass("less"),
                e.html(t.lessText),
                e.prev().removeClass("shortened")),
                !1
            }
        }, ".morelink"),
        this.each(function() {
            var e = $(this);
            e.hasClass("shortened") || e.height() > t.maxHeight && (e.addClass("shortened"),
            $('<a href="#" class="morelink">' + t.moreText + "</a>").insertAfter(e))
        })
    }
    ,
    $(".detail-content p").shorten(),
    function() {
        var e = location.hash.substr(1);
        if (null != e && e.indexOf("page_") >= 0) {
            var t = parseInt(e.replace("page_", ""));
            if (0 == isNaN(t) && t > 0) {
                var n = 0;
                t >= 2 && (n = t - 1);
                for (var i = 1; i <= n; i++)
                    $("#page_" + i + " img").attr("src", "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"),
                    $("#page_" + i).addClass("page-hidden").hide();
                n > 0 && (n > 5 ? ($('<div class="text-center mrb10 show-images hidden"><a class="btn btn-success">Xem ' + (n - 3) + ' ảnh còn lại <i class="fa fa-search-plus"></i></a></div>').insertAfter($("#page_1")),
                $('<div class="text-center mrb10 show-top-images"><a class="btn btn-success">Xem 3 ảnh trước <i class="fa fa-search-plus"></i></a></div>').insertAfter($("#page_" + n))) : $('<div class="text-center mrb10 show-images"><a class="btn btn-success">Xem ' + n + ' ảnh đang ẩn <i class="fa fa-search-plus"></i></a></div>').insertAfter($("#page_1")))
            }
        }
    }(),
    $(".show-top-images a").click(function() {
        for (var e = 1, t = $(".page-hidden").length - 1; t >= 0 && !(e > 3); t--) {
            var n = $(".page-hidden img").eq(t);
            n.attr("src", n.attr("data-original")),
            n.parent().show().removeClass("page-hidden"),
            e += 1
        }
        return $(this).parent().remove(),
        $(".show-images").removeClass("hidden"),
        !1
    }),
    $(".show-images a").click(function() {
        return $(".page-hidden img").each(function() {
            $(this).attr("src", $(this).attr("data-original")),
            $(this).parent().show().removeClass("page-hidden")
        }),
        $(this).parent().remove(),
        !1
    }),
    $(".user-sidebar").click(function() {
        var e = $(this).find(".fa");
        e.hasClass("fa-angle-down") ? ($(".user-sidelink").addClass("hidden"),
        e.removeClass("active").removeClass("fa-angle-down").addClass("fa-angle-up")) : ($(".user-sidelink").removeClass("hidden"),
        e.addClass("active").removeClass("fa-angle-up").addClass("fa-angle-down"))
    }),
    t < 768 && $(".user-sidebar").trigger("click"),
    $(".list-chapter .view-more").click(function() {
        return $(".list-chapter ul li.less").addClass("active"),
        $(this).remove(),
        !1
    }),
    $(".dropdown-genres").length && $(".dropdown-genres").insertAfter($(".comic-filter h1")),
    $(".advsearch-page .genre-item").click(function() {
        var e = $(this).find("span");
        e.hasClass("icon-checkbox") ? e.removeClass("icon-checkbox").addClass("icon-tick") : e.hasClass("icon-tick") ? e.removeClass("icon-tick").addClass("icon-cross") : e.removeClass("icon-cross").addClass("icon-checkbox")
    }),
    $(".advsearch-page .btn-collapse").click(function() {
        $(this).find(".show-text").toggleClass("hidden"),
        $(this).find(".hide-text").toggleClass("hidden"),
        $(this).find(".fa").toggleClass("fa-angle-double-down").toggleClass("fa-angle-double-up"),
        $(".advsearch-form").toggleClass("hidden")
    }),
    $(".advsearch-page .btn-search").click(function() {
        var e = $(".btn-reset").attr("href")
          , t = ""
          , n = ""
          , i = ""
          , a = "";
        $.each($(".genre-item span"), function(e, o) {
            $(o).hasClass("icon-tick") ? (t += i + $(o).attr("data-id"),
            i = ",") : $(o).hasClass("icon-cross") && (n += a + $(o).attr("data-id"),
            a = ",")
        }),
        location.href = e + "?genres=" + t + "&notgenres=" + n + "&gender=" + $(".select-gender").val() + "&status=" + $(".select-status").val() + "&minchapter=" + $(".select-minchapter").val() + "&sort=" + $(".select-sort").val()
    }),
    $(".chapter a").length) && ("undefined" != typeof Storage && void 0 !== localStorage["visited-chapters"] && (S = JSON.parse(localStorage["visited-chapters"])).forEach(function(e) {
        $('.chapter a[href$="/' + e + '"]').addClass("visited")
    }));
    if ($("body").hasClass("chapter-detail")) {
        if ("undefined" != typeof Storage && (h = parseInt($(".chapter-id").data("id")))) {
            if (void 0 !== localStorage["visited-chapters"]) {
                if (-1 == (S = JSON.parse(localStorage["visited-chapters"])).indexOf(h)) {
                    if (S.push(h),
                    S.length > 2e3)
                        for (d = 0; d < 1500; d++)
                            S.shift();
                    localStorage["visited-chapters"] = JSON.stringify(S)
                }
            } else
                (E = []).push(h),
                localStorage["visited-chapters"] = JSON.stringify(E);
            var C = $(".breadcrumb li").eq(2).find("a")
              , w = $(".breadcrumb li").eq(3).find("a")
              , y = $('meta[itemprop="image"]').attr("content");
            if (C && w && y) {
                var x = journalOptions.comicId
                  , k = {
                    id: x,
                    image: y,
                    name: C.find("span").html(),
                    url: C.attr("href"),
                    chapterName: w.find("span").html(),
                    chapterUrl: w.attr("href")
                };
                if (void 0 !== localStorage["visited-comics"]) {
                    var A = (S = JSON.parse(localStorage["visited-comics"])).map(function(e) {
                        return e.id
                    }).indexOf(x);
                    if (A > -1 && S.splice(A, 1),
                    S.push(k),
                    S.length > 96)
                        for (d = 96; d < S.length; d++)
                            S.shift();
                    localStorage["visited-comics"] = JSON.stringify(S)
                } else {
                    (E = []).push(k),
                    localStorage["visited-comics"] = JSON.stringify(E)
                }
            }
        }
    } else if ($("body").hasClass("comic-detail") && !$(".read-continue").length) {
        var S;
        if ("undefined" != typeof Storage)
            if (void 0 !== localStorage["visited-comics"])
                if ((S = JSON.parse(localStorage["visited-comics"])).length > 0)
                    for (d = S.length - 1; d >= 0; d--)
                        if (S[d].id == journalOptions.comicId) {
                            var T = $("<a>").html('Đọc tiếp <i class="fa fa-angle-right"></i>').attr("class", "read-continue btn btn-danger mrb5").attr("href", S[d].chapterUrl);
                            $(".read-action").append(T);
                            break
                        }
    }
    if ($(".visited-comics-page").length && "undefined" != typeof Storage)
        if (void 0 !== localStorage["visited-comics"])
            if ((S = JSON.parse(localStorage["visited-comics"])).length > 0) {
                var _ = $("<div>").addClass("row");
                for (d = S.length - 1; d >= 0; d--) {
                    var I = S[d]
                      , E = $("<div>").addClass("item")
                      , O = $("<figure>").addClass("clearfix")
                      , R = $("<div>").addClass("image")
                      , H = $("<a>").attr("title", I.name).attr("href", I.url)
                      , j = $("<img>").addClass("lazy").attr("alt", I.name).attr("data-original", I.image).attr("src", "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7")
                      , L = $("<div>").addClass("view");
                    $("<a>").addClass("visited-remove").attr("href", "#").data("id", I.id).html('<i class="fa fa-times"></i> Xóa').click(function(e) {
                        return e.preventDefault(),
                        z($(this)),
                        !1
                    }).appendTo(L);
                    H.append(j),
                    R.append(H).append(L);
                    var N = $("<figcaption>")
                      , B = $("<h3>")
                      , M = $("<ul>")
                      , D = $("<li>").addClass("chapter clearfix")
                      , P = $("<a>").html('Đọc tiếp <i class="fa fa-angle-right"></i>').attr("href", I.chapterUrl)
                      , U = $("<i>").text(I.chapterName).addClass("time")
                      , W = $("<a>").html(I.name).attr("title", I.name).attr("href", I.url);
                    B.append(W),
                    D.append(P).append(U),
                    M.append(D),
                    N.append(B).append(M),
                    O.append(R).append(N),
                    E.append(O),
                    _.append(E)
                }
                $(".visited-comics-page").empty().append(_),
                K()
            } else
                $(".visited-comics-page").html("Bạn chưa đọc truyện nào.");
        else
            $(".visited-comics-page").html("Bạn chưa đọc truyện nào.");
    if ($(".visited-comics").length && ("undefined" != typeof Storage && void 0 !== localStorage["visited-comics"] && (S = JSON.parse(localStorage["visited-comics"])).length > 0)) {
        _ = $("<div>").addClass("box darkBox").html('<h2>Lịch sử đọc truyện<a class="view-all" href="/lich-su">Xem tất cả</a></h2>'),
        M = $("<ul>").addClass("list-unstyled");
        var F = 0;
        for (d = S.length - 1; d >= 0; d--) {
            I = S[d],
            D = $("<li>").addClass("clearfix");
            var J = $("<div>").addClass("t-item");
            D.append(J);
            H = $("<a>").addClass("thumb").attr("title", I.name).attr("href", I.chapterUrl),
            j = $("<img>").attr("alt", I.name).attr("src", I.image);
            H.append(j),
            J.append(H);
            B = $("<h3>").addClass("title"),
            W = $("<a>").html(I.name).attr("href", I.chapterUrl);
            B.append(W),
            J.append(B);
            var q = $("<p>").addClass("chapter")
              , G = $("<a>").html("Đọc tiếp " + I.chapterName + ' <i class="fa fa-angle-right"></i>').attr("href", I.chapterUrl)
              , V = $("<span>").addClass("view pull-right");
            $("<a>").addClass("visited-remove").attr("href", "#").data("id", I.id).html('<i class="fa fa-times"></i> Xóa').click(function(e) {
                return e.preventDefault(),
                z($(this)),
                !1
            }).appendTo(V);
            if (q.append(G).append(V),
            J.append(q),
            M.append(D),
            ++F > 2)
                break
        }
        _.append(M),
        $(".visited-comics").append(_)
    }
    function z(e) {
        if ("undefined" != typeof Storage && void 0 !== localStorage["visited-comics"]) {
            var t = JSON.parse(localStorage["visited-comics"])
              , n = $(e).data("id");
            if (t.length > 0) {
                var i = t.map(function(e) {
                    return e.id
                }).indexOf(n);
                i > -1 && (t.splice(i, 1),
                localStorage["visited-comics"] = JSON.stringify(t),
                $(e).parents(".item").remove(),
                $(e).parents("li").remove())
            }
        }
    }
    function K() {
        $("img.lazy").lazyload({
            effect: "fadeIn",
            effectspeed: 300,
            failure_limit: 999,
            threshold: 50
        })
    }
    function X() {
        return globalOpts.userGuid ? globalOpts.userGuid : null
    }
    function Q(e) {
        return e
    }
    $(".floatads .title").click(function() {
        $(this).parent().remove()
    }),
    $(".floatads").length && t < 1290 && ($(".leftbanner").remove(),
    $(".rightbanner").addClass("hidden"));
    var Y = !1;
    function Z(e) {
        var t = journalOptions.comicId;
        if (0 == e) {
            var n = -1
              , i = window.location.hash.split("#cmt-");
            0 == isNaN(parseInt(i[1])) && parseInt(i[1]) > 0 && (n = parseInt(i[1]));
            var a = {
                comicId: t,
                commentId: n
            };
            n > 0 && $.ajax({
                type: "POST",
                url: "/Comic/Services/ComicService.asmx/ProcessComicLoader",
                data: a,
                success: function(e) {
                    e.success && (e.commentCount && $(".comment-count").text(e.commentCount),
                    e.commentsHtml && ($(".journalItems").html(e.commentsHtml),
                    e.pagerHtml && ($(".sort-comment").parent().removeClass("hidden"),
                    $(".commentpager").html(e.pagerHtml)),
                    pluginInit(),
                    shortenCommentText()),
                    e.followedListHtml && ($(".comics-followed-block").html(e.followedListHtml),
                    K()),
                    e.followHtml && $(".follow").prepend(e.followHtml),
                    e.readHtml && ($(".read-continue").length ? $(".read-continue").attr("href", $(e.readHtml).attr("href")) : $(".read-action").append(e.readHtml)),
                    e.markAsReadHtml && $(".list-chapter h2.list-title").append(e.markAsReadHtml),
                    e.readChapters && e.readChapters.length > 0 && $(".list-chapter .chapter a").each(function() {
                        $.inArray($(this).attr("data-id"), e.readChapters) > -1 && $(this).addClass("visited")
                    }),
                    e.commentReplyHtml && ($("body").addClass("modal-open").append(e.commentReplyHtml),
                    pluginInit(),
                    shortenCommentText()))
                }
            })
        }
        $.ajax({
            type: "GET",
            url: siteRoot + "/Comic/Services/ComicService.asmx/GetFollowedButtonComic",
            data: {
                comicId: t,
                userGuid: X(),
                token: globalOpts.userKey ? globalOpts.userKey : ""
            },
            success: function(t) {
                t.success && (1 == t.isFollowed && (Y = !0),
                t.followHtml && (1 == e ? $(".chapter-nav").append(t.followHtml) : $(".follow").prepend(t.followHtml)),
                t.readHtml && ($(".read-continue").length ? $(".read-continue").attr("href", $(t.readHtml).attr("href")) : $(".read-action").append(Q(t.readHtml))),
                t.markAsReadHtml && $(".list-chapter h2.list-title").append(t.markAsReadHtml),
                t.readChapters && t.readChapters.length > 0 && $(".list-chapter .chapter a").each(function() {
                    $.inArray($(this).attr("data-id"), t.readChapters) > -1 && $(this).addClass("visited")
                }))
            },
            error: function(e, t, n) {
                console.log(n)
            }
        })
    }
    var ee = "BMTsrKytzFJ_B4s0E-tjymP7w5EH-y4niV-8vieJrJxgJJICvvieZPiLlcBRT_z3U69SC40I-6zJd2a8W9Fd11I"
      , te = $(".push-btn")
      , ne = !1
      , ie = null;
    function ae(e) {
        if (te.removeClass("denied").removeClass("subcribed"),
        $(".push-popup").addClass("hidden"),
        "denied" === Notification.permission)
            return te.attr("title", "Bạn đã chặn thông báo"),
            te.addClass("denied"),
            te.attr("href", "#push-popup-unblock"),
            void $("#notify-unblock").removeClass("hidden");
        ne ? (te.attr("title", "Hủy nhận thông báo"),
        te.addClass("subcribed"),
        te.attr("href", "#push-popup-unsubcriber"),
        $("#notify-unsubcriber").removeClass("hidden")) : (te.attr("title", "Nhận thông báo truyện"),
        te.attr("href", "#push-popup-subcriber"),
        $("#notify-subcriber").removeClass("hidden"))
    }
    function oe(e, t) {
        if (e) {
            var n = e.getKey ? e.getKey("p256dh") : ""
              , i = n ? btoa(String.fromCharCode.apply(null, new Uint8Array(n))) : ""
              , a = e.getKey ? e.getKey("auth") : ""
              , o = a ? btoa(String.fromCharCode.apply(null, new Uint8Array(a))) : "";
            $.ajax({
                url: "/Comic/Services/ComicService.asmx/UpdateSubscription",
                type: "post",
                dataType: "json",
                data: {
                    endpoint: e.endpoint,
                    key: i,
                    authSecret: o,
                    isRemoved: t
                },
                success: function(e) {}
            })
        }
    }
    function re() {
        var e = function(e) {
            for (var t = (e + "=".repeat((4 - e.length % 4) % 4)).replace(/\-/g, "+").replace(/_/g, "/"), n = window.atob(t), i = new Uint8Array(n.length), a = 0; a < n.length; ++a)
                i[a] = n.charCodeAt(a);
            return i
        }(ee);
        ie.pushManager.subscribe({
            userVisibleOnly: !0,
            applicationServerKey: e
        }).then(function(e) {
            oe(e, !1),
            alert("Đăng ký thành công!"),
            ne = !0,
            ae()
        }).catch(function(e) {
            ae()
        })
    }
    function se() {
        $("body").on("click", ".push-launch-btn", function(e) {
            var t;
            ne ? (t = null,
            ie.pushManager.getSubscription().then(function(e) {
                if (e)
                    return t = e,
                    e.unsubscribe()
            }).catch(function(e) {}).then(function() {
                oe(t, !0),
                alert("Hủy đăng ký thành công!"),
                ne = !1,
                ae()
            })) : re(),
            e.preventDefault()
        }),
        $("body").on("click", ".push-close-btn", function(e) {
            $(".push-popup").addClass("hidden"),
            e.preventDefault()
        }),
        $("body").on("click", ".push-btn", function(e) {
            ae(),
            $(te.attr("href")).removeClass("hidden"),
            e.preventDefault()
        }),
        ie.pushManager.getSubscription().then(function(e) {
            ne = !(null === e);
            var t = Get_Cookie("endpoint");
            ne ? t ? e.endpoint.toLowerCase() != t.toLowerCase() && oe(e, !1) : oe(e, !1) : t && oe(e, !0),
            ae(),
            te.trigger("click")
        })
    }
    function ce(e) {
        var t = []
          , n = document.querySelectorAll(e);
        if ([].forEach.call(n, function(e, n) {
            t.push(e)
        }),
        t.length > 0) {
            if (function() {
                "use strict";
                if ("object" == typeof window)
                    if ("IntersectionObserver"in window && "IntersectionObserverEntry"in window && "intersectionRatio"in window.IntersectionObserverEntry.prototype)
                        "isIntersecting"in window.IntersectionObserverEntry.prototype || Object.defineProperty(window.IntersectionObserverEntry.prototype, "isIntersecting", {
                            get: function() {
                                return this.intersectionRatio > 0
                            }
                        });
                    else {
                        var e = window.document
                          , t = []
                          , n = null
                          , i = null;
                        o.prototype.THROTTLE_TIMEOUT = 100,
                        o.prototype.POLL_INTERVAL = null,
                        o.prototype.USE_MUTATION_OBSERVER = !0,
                        o._setupCrossOriginUpdater = function() {
                            return n || (n = function(e, n) {
                                i = e && n ? d(e, n) : {
                                    top: 0,
                                    bottom: 0,
                                    left: 0,
                                    right: 0,
                                    width: 0,
                                    height: 0
                                },
                                t.forEach(function(e) {
                                    e._checkForIntersections()
                                })
                            }
                            ),
                            n
                        }
                        ,
                        o._resetCrossOriginUpdater = function() {
                            n = null,
                            i = null
                        }
                        ,
                        o.prototype.observe = function(e) {
                            if (!this._observationTargets.some(function(t) {
                                return t.element == e
                            })) {
                                if (!e || 1 != e.nodeType)
                                    throw new Error("target must be an Element");
                                this._registerInstance(),
                                this._observationTargets.push({
                                    element: e,
                                    entry: null
                                }),
                                this._monitorIntersections(e.ownerDocument),
                                this._checkForIntersections()
                            }
                        }
                        ,
                        o.prototype.unobserve = function(e) {
                            this._observationTargets = this._observationTargets.filter(function(t) {
                                return t.element != e
                            }),
                            this._unmonitorIntersections(e.ownerDocument),
                            0 == this._observationTargets.length && this._unregisterInstance()
                        }
                        ,
                        o.prototype.disconnect = function() {
                            this._observationTargets = [],
                            this._unmonitorAllIntersections(),
                            this._unregisterInstance()
                        }
                        ,
                        o.prototype.takeRecords = function() {
                            var e = this._queuedEntries.slice();
                            return this._queuedEntries = [],
                            e
                        }
                        ,
                        o.prototype._initThresholds = function(e) {
                            var t = e || [0];
                            return Array.isArray(t) || (t = [t]),
                            t.sort().filter(function(e, t, n) {
                                if ("number" != typeof e || isNaN(e) || e < 0 || e > 1)
                                    throw new Error("threshold must be a number between 0 and 1 inclusively");
                                return e !== n[t - 1]
                            })
                        }
                        ,
                        o.prototype._parseRootMargin = function(e) {
                            var t = (e || "0px").split(/\s+/).map(function(e) {
                                var t = /^(-?\d*\.?\d+)(px|%)$/.exec(e);
                                if (!t)
                                    throw new Error("rootMargin must be specified in pixels or percent");
                                return {
                                    value: parseFloat(t[1]),
                                    unit: t[2]
                                }
                            });
                            return t[1] = t[1] || t[0],
                            t[2] = t[2] || t[0],
                            t[3] = t[3] || t[1],
                            t
                        }
                        ,
                        o.prototype._monitorIntersections = function(t) {
                            var n = t.defaultView;
                            if (n && -1 == this._monitoringDocuments.indexOf(t)) {
                                var i = this._checkForIntersections
                                  , a = null
                                  , o = null;
                                if (this.POLL_INTERVAL ? a = n.setInterval(i, this.POLL_INTERVAL) : (r(n, "resize", i, !0),
                                r(t, "scroll", i, !0),
                                this.USE_MUTATION_OBSERVER && "MutationObserver"in n && (o = new n.MutationObserver(i)).observe(t, {
                                    attributes: !0,
                                    childList: !0,
                                    characterData: !0,
                                    subtree: !0
                                })),
                                this._monitoringDocuments.push(t),
                                this._monitoringUnsubscribes.push(function() {
                                    var e = t.defaultView;
                                    e && (a && e.clearInterval(a),
                                    s(e, "resize", i, !0)),
                                    s(t, "scroll", i, !0),
                                    o && o.disconnect()
                                }),
                                t != (this.root && this.root.ownerDocument || e)) {
                                    var c = p(t);
                                    c && this._monitorIntersections(c.ownerDocument)
                                }
                            }
                        }
                        ,
                        o.prototype._unmonitorIntersections = function(t) {
                            var n = this._monitoringDocuments.indexOf(t);
                            if (-1 != n) {
                                var i = this.root && this.root.ownerDocument || e;
                                if (!this._observationTargets.some(function(e) {
                                    var n = e.element.ownerDocument;
                                    if (n == t)
                                        return !0;
                                    for (; n && n != i; ) {
                                        var a = p(n);
                                        if ((n = a && a.ownerDocument) == t)
                                            return !0
                                    }
                                    return !1
                                })) {
                                    var a = this._monitoringUnsubscribes[n];
                                    if (this._monitoringDocuments.splice(n, 1),
                                    this._monitoringUnsubscribes.splice(n, 1),
                                    a(),
                                    t != i) {
                                        var o = p(t);
                                        o && this._unmonitorIntersections(o.ownerDocument)
                                    }
                                }
                            }
                        }
                        ,
                        o.prototype._unmonitorAllIntersections = function() {
                            var e = this._monitoringUnsubscribes.slice(0);
                            this._monitoringDocuments.length = 0,
                            this._monitoringUnsubscribes.length = 0;
                            for (var t = 0; t < e.length; t++)
                                e[t]()
                        }
                        ,
                        o.prototype._checkForIntersections = function() {
                            if (this.root || !n || i) {
                                var e = this._rootIsInDom()
                                  , t = e ? this._getRootRect() : {
                                    top: 0,
                                    bottom: 0,
                                    left: 0,
                                    right: 0,
                                    width: 0,
                                    height: 0
                                };
                                this._observationTargets.forEach(function(i) {
                                    var o = i.element
                                      , r = c(o)
                                      , s = this._rootContainsTarget(o)
                                      , l = i.entry
                                      , d = e && s && this._computeTargetAndRootIntersection(o, r, t)
                                      , h = i.entry = new a({
                                        time: window.performance && performance.now && performance.now(),
                                        target: o,
                                        boundingClientRect: r,
                                        rootBounds: n && !this.root ? null : t,
                                        intersectionRect: d
                                    });
                                    l ? e && s ? this._hasCrossedThreshold(l, h) && this._queuedEntries.push(h) : l && l.isIntersecting && this._queuedEntries.push(h) : this._queuedEntries.push(h)
                                }, this),
                                this._queuedEntries.length && this._callback(this.takeRecords(), this)
                            }
                        }
                        ,
                        o.prototype._computeTargetAndRootIntersection = function(t, a, o) {
                            if ("none" != window.getComputedStyle(t).display) {
                                for (var r, s, l, h, p, f, m, g, v = a, $ = u(t), b = !1; !b && $; ) {
                                    var C = null
                                      , w = 1 == $.nodeType ? window.getComputedStyle($) : {};
                                    if ("none" == w.display)
                                        return null;
                                    if ($ == this.root || 9 == $.nodeType)
                                        if (b = !0,
                                        $ == this.root || $ == e)
                                            n && !this.root ? !i || 0 == i.width && 0 == i.height ? ($ = null,
                                            C = null,
                                            v = null) : C = i : C = o;
                                        else {
                                            var y = u($)
                                              , x = y && c(y)
                                              , k = y && this._computeTargetAndRootIntersection(y, x, o);
                                            x && k ? ($ = y,
                                            C = d(x, k)) : ($ = null,
                                            v = null)
                                        }
                                    else {
                                        var A = $.ownerDocument;
                                        $ != A.body && $ != A.documentElement && "visible" != w.overflow && (C = c($))
                                    }
                                    if (C && (r = C,
                                    s = v,
                                    void 0,
                                    void 0,
                                    void 0,
                                    void 0,
                                    void 0,
                                    void 0,
                                    l = Math.max(r.top, s.top),
                                    h = Math.min(r.bottom, s.bottom),
                                    p = Math.max(r.left, s.left),
                                    g = h - l,
                                    v = (m = (f = Math.min(r.right, s.right)) - p) >= 0 && g >= 0 && {
                                        top: l,
                                        bottom: h,
                                        left: p,
                                        right: f,
                                        width: m,
                                        height: g
                                    } || null),
                                    !v)
                                        break;
                                    $ = $ && u($)
                                }
                                return v
                            }
                        }
                        ,
                        o.prototype._getRootRect = function() {
                            var t;
                            if (this.root)
                                t = c(this.root);
                            else {
                                var n = e.documentElement
                                  , i = e.body;
                                t = {
                                    top: 0,
                                    left: 0,
                                    right: n.clientWidth || i.clientWidth,
                                    width: n.clientWidth || i.clientWidth,
                                    bottom: n.clientHeight || i.clientHeight,
                                    height: n.clientHeight || i.clientHeight
                                }
                            }
                            return this._expandRectByRootMargin(t)
                        }
                        ,
                        o.prototype._expandRectByRootMargin = function(e) {
                            var t = this._rootMarginValues.map(function(t, n) {
                                return "px" == t.unit ? t.value : t.value * (n % 2 ? e.width : e.height) / 100
                            })
                              , n = {
                                top: e.top - t[0],
                                right: e.right + t[1],
                                bottom: e.bottom + t[2],
                                left: e.left - t[3]
                            };
                            return n.width = n.right - n.left,
                            n.height = n.bottom - n.top,
                            n
                        }
                        ,
                        o.prototype._hasCrossedThreshold = function(e, t) {
                            var n = e && e.isIntersecting ? e.intersectionRatio || 0 : -1
                              , i = t.isIntersecting ? t.intersectionRatio || 0 : -1;
                            if (n !== i)
                                for (var a = 0; a < this.thresholds.length; a++) {
                                    var o = this.thresholds[a];
                                    if (o == n || o == i || o < n != o < i)
                                        return !0
                                }
                        }
                        ,
                        o.prototype._rootIsInDom = function() {
                            return !this.root || h(e, this.root)
                        }
                        ,
                        o.prototype._rootContainsTarget = function(t) {
                            return h(this.root || e, t) && (!this.root || this.root.ownerDocument == t.ownerDocument)
                        }
                        ,
                        o.prototype._registerInstance = function() {
                            t.indexOf(this) < 0 && t.push(this)
                        }
                        ,
                        o.prototype._unregisterInstance = function() {
                            var e = t.indexOf(this);
                            -1 != e && t.splice(e, 1)
                        }
                        ,
                        window.IntersectionObserver = o,
                        window.IntersectionObserverEntry = a
                    }
                function a(e) {
                    this.time = e.time,
                    this.target = e.target,
                    this.rootBounds = l(e.rootBounds),
                    this.boundingClientRect = l(e.boundingClientRect),
                    this.intersectionRect = l(e.intersectionRect || {
                        top: 0,
                        bottom: 0,
                        left: 0,
                        right: 0,
                        width: 0,
                        height: 0
                    }),
                    this.isIntersecting = !!e.intersectionRect;
                    var t = this.boundingClientRect
                      , n = t.width * t.height
                      , i = this.intersectionRect
                      , a = i.width * i.height;
                    this.intersectionRatio = n ? Number((a / n).toFixed(4)) : this.isIntersecting ? 1 : 0
                }
                function o(e, t) {
                    var n, i, a, o = t || {};
                    if ("function" != typeof e)
                        throw new Error("callback must be a function");
                    if (o.root && 1 != o.root.nodeType)
                        throw new Error("root must be an Element");
                    this._checkForIntersections = (n = this._checkForIntersections.bind(this),
                    i = this.THROTTLE_TIMEOUT,
                    a = null,
                    function() {
                        a || (a = setTimeout(function() {
                            n(),
                            a = null
                        }, i))
                    }
                    ),
                    this._callback = e,
                    this._observationTargets = [],
                    this._queuedEntries = [],
                    this._rootMarginValues = this._parseRootMargin(o.rootMargin),
                    this.thresholds = this._initThresholds(o.threshold),
                    this.root = o.root || null,
                    this.rootMargin = this._rootMarginValues.map(function(e) {
                        return e.value + e.unit
                    }).join(" "),
                    this._monitoringDocuments = [],
                    this._monitoringUnsubscribes = []
                }
                function r(e, t, n, i) {
                    "function" == typeof e.addEventListener ? e.addEventListener(t, n, i || !1) : "function" == typeof e.attachEvent && e.attachEvent("on" + t, n)
                }
                function s(e, t, n, i) {
                    "function" == typeof e.removeEventListener ? e.removeEventListener(t, n, i || !1) : "function" == typeof e.detatchEvent && e.detatchEvent("on" + t, n)
                }
                function c(e) {
                    var t;
                    try {
                        t = e.getBoundingClientRect()
                    } catch (e) {}
                    return t ? (t.width && t.height || (t = {
                        top: t.top,
                        right: t.right,
                        bottom: t.bottom,
                        left: t.left,
                        width: t.right - t.left,
                        height: t.bottom - t.top
                    }),
                    t) : {
                        top: 0,
                        bottom: 0,
                        left: 0,
                        right: 0,
                        width: 0,
                        height: 0
                    }
                }
                function l(e) {
                    return !e || "x"in e ? e : {
                        top: e.top,
                        y: e.top,
                        bottom: e.bottom,
                        left: e.left,
                        x: e.left,
                        right: e.right,
                        width: e.width,
                        height: e.height
                    }
                }
                function d(e, t) {
                    var n = t.top - e.top
                      , i = t.left - e.left;
                    return {
                        top: n,
                        left: i,
                        height: t.height,
                        width: t.width,
                        bottom: n + t.height,
                        right: i + t.width
                    }
                }
                function h(e, t) {
                    for (var n = t; n; ) {
                        if (n == e)
                            return !0;
                        n = u(n)
                    }
                    return !1
                }
                function u(t) {
                    var n = t.parentNode;
                    return 9 == t.nodeType && t != e ? p(t) : n && 11 == n.nodeType && n.host ? n.host : n && n.assignedSlot ? n.assignedSlot.parentNode : n
                }
                function p(e) {
                    try {
                        return e.defaultView && e.defaultView.frameElement || null
                    } catch (e) {
                        return null
                    }
                }
            }(),
            "IntersectionObserver"in window) {
                var i = new IntersectionObserver(function(e, t) {
                    e.forEach(function(e) {
                        e.intersectionRatio > 0 && (l(e.target),
                        t.unobserve(e.target))
                    })
                }
                ,{
                    rootMargin: "200px 0px 200px 0px",
                    threshold: 0
                });
                t.forEach(function(e) {
                    i.observe(e)
                })
            } else {
                var a = !1
                  , o = function() {
                    !1 === a && (a = !0,
                    setTimeout(function() {
                        t.forEach(function(e) {
                            e.getBoundingClientRect().top - 200 <= window.innerHeight && e.getBoundingClientRect().bottom + 200 >= 0 && "none" !== getComputedStyle(e).display && (l(e),
                            0 === (t = t.filter(function(t) {
                                return t !== e
                            })).length && (window.addEventListener ? (removeEventListener("scroll", o),
                            removeEventListener("resize", o)) : window.attachEvent && (detachEvent("onscroll", o),
                            detachEvent("onresize", o))))
                        }),
                        a = !1
                    }, 200))
                };
                window.addEventListener ? (addEventListener("DOMContentLoaded", o, !1),
                addEventListener("load", o, !1),
                addEventListener("scroll", o, !1),
                addEventListener("resize", o, !1)) : window.attachEvent && (attachEvent("onDOMContentLoaded", o),
                attachEvent("onload", o),
                attachEvent("onscroll", o),
                attachEvent("onresize", o))
            }
            var r = !1
              , s = !1
              , c = !1;
            function l(t) {
                if (null != t) {
                    var n = t.getAttribute("data-type");
                    if (".comics-followed-block" == e) {
                        if (0 == s)
                            null != (i = X()) && $.ajax({
                                type: "GET",
                                url: siteRoot + "/Comic/Services/ComicService.asmx/GetFollowedBlockComics",
                                data: {
                                    userGuid: i,
                                    token: globalOpts.userKey ? globalOpts.userKey : ""
                                },
                                success: function(e) {
                                    e.success && e.followedListHtml && ($(".comics-followed-block").html(Q(e.followedListHtml)),
                                    K())
                                }
                            }),
                            s = !0
                    } else if (".chapter-nav-bottom" == e) {
                        if (0 == c) {
                            var i = ""
                              , a = "";
                            1 == Y && (null == (i = X()) && (i = ""),
                            "" != i && globalOpts.userKey && (a = globalOpts.userKey)),
                            $.ajax({
                                type: "POST",
                                url: siteRoot + "/Comic/Services/ComicService.asmx/ProcessChapterLoaded",
                                data: {
                                    chapterId: $(".chapter-id").attr("data-id"),
                                    userGuid: i,
                                    token: a
                                },
                                success: function(e) {}
                            }),
                            c = !0
                        }
                    } else
                        "facebook" == n && 0 == r && (window.fbAsyncInit = function() {
                            FB.init({
                                appId: "745819368841087",
                                status: !1,
                                cookie: !0,
                                version: "v2.0",
                                xfbml: !0,
                                oauth: !0
                            })
                        }
                        ,
                        o = document,
                        l = "script",
                        d = "facebook-jssdk",
                        u = o.getElementsByTagName(l)[0],
                        o.getElementById(d) || ((h = o.createElement(l)).id = d,
                        h.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=745819368841087&version=v2.7",
                        u.parentNode.insertBefore(h, u)),
                        r = !0)
                }
                var o, l, d, h, u
            }
        }
    }
    "serviceWorker"in navigator && "PushManager"in window ? ($(".notify-btn").removeClass("hidden"),
    $(".notification-page").length && $("a").each(function(e, t) {
        $(t).attr("href") && !$(t).hasClass("notify-btn") && ("/" == $(t).attr("href") ? $(t).attr("href", "http://www." + hostName) : $(t).attr("href", $(t).attr("href").replace("https://www." + hostName, "//www." + hostName).replace("http://www." + hostName, "//www." + hostName).replace("//www." + hostName, "http://www." + hostName)))
    }),
    navigator.serviceWorker.register("/sw.js").then(function(e) {
        te.removeClass("hidden"),
        ie = e,
        se()
    }).catch(function(e) {})) : $("#notify-notsupport").removeClass("hidden"),
    ce(".lazy-module")
});
